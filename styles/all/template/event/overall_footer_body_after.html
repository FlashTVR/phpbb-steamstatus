<!-- IF S_STEAMSTATUS -->
<script type="text/javascript">
(function ($) {
	'use strict';
	$(function() {
		$.steamstatusRefresh = function () {
			var refreshInterval = {STEAMSTATUS_REFRESH};

			var steamids = {};
			$('.steamstatus').each(function () {
				var steamid = $(this).data('steamid');
				if (steamid) {
					steamids[steamid] = true;
				}
			});
			steamids = Object.keys(steamids);
			if (steamids.length > 0) {
				$.ajax({
					url: '{U_STEAMSTATUS_CONTROLLER}',
					dataType: 'json',
					cache: false,
					data: {'steamids': steamids.join(',')}
				})
				.done(function(data) {
					$.each(data.status, function(index, val) {
						var container = $('.steamstatus[data-steamid=' + val.steamid + ']');
						container.removeClass('steam-online').removeClass('steam-ingame');
						if (val.state === 1) {
							container.addClass('steam-online');
						} else if (val.state === 2) {
							container.addClass('steam-ingame');
						}
						container.children('img').attr({'src': val.avatar, 'alt': '{LA_STEAMSTATUS_AVATAR_ALT}'.replace('%s', val.name)});
						container.find('.steam-name').text(val.name).attr({'href': val.profile, 'title': val.name});
						container.find('.steam-status').text(val.status).attr('title', val.status);
						container.find('.steam-profile').attr({'href': val.profile, 'title': '{LA_STEAMSTATUS_PROFILE_LINK}'.replace('%s', val.name)});
						container.find('.steam-add').attr({'href': val.profile, 'title': '{LA_STEAMSTATUS_ADD_LINK}'.replace('%s', val.name)});
					});
				});
			}

			if (refreshInterval > 0) {
				setTimeout($.steamstatusRefresh, refreshInterval);
			}
		};
		$.steamstatusRefresh();
	});
}(jQuery));
</script>
<!-- ENDIF -->
